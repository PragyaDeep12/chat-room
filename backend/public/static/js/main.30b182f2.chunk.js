(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{110:function(e,t,a){e.exports=a.p+"static/media/happy.fe43d80f.svg"},111:function(e,t,a){e.exports=a.p+"static/media/sad.a196067d.svg"},112:function(e,t,a){e.exports=a.p+"static/media/confused.c30d3d43.svg"},113:function(e,t,a){e.exports=a.p+"static/media/angry.bfb96aea.svg"},114:function(e,t,a){e.exports=a.p+"static/media/scared.882b3ad5.svg"},117:function(e,t,a){e.exports=a.p+"static/media/app-icon.0072162b.svg"},120:function(e,t,a){e.exports=a(280)},125:function(e,t,a){},126:function(e,t,a){e.exports=a.p+"static/media/logo.ee7cd8ed.svg"},127:function(e,t,a){},128:function(e,t,a){},130:function(e,t,a){},163:function(e,t){},280:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(107),c=a.n(s),o=(a(125),a(119)),i=(a(126),a(127),a(128),a(129),a(130),a(10)),u=a.n(i),l=a(4),m=a(140)("https://limitless-chamber-11506.herokuapp.com/");var f=a(19),p=a(14),d=a(5),g=a.n(d),b=a(8);function h(){var e=!1;return Object(n.useEffect)(function(){e||(e=!0)},[]),r.a.createElement("div",null,r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},r.a.createElement("a",{href:"#",className:"navbar-brand"},r.a.createElement("img",{className:"chat-icon"}),"Chat Room"),r.a.createElement("button",{type:"button",className:"navbar-logout",onClick:Object(b.a)(g.a.mark(function e(){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return m.disconnect(),e.next=3,u.a.auth().signOut();case 3:case"end":return e.stop()}},e)}))},"logout")))}var E=a(7),v=a.n(E),j=r.a.createContext({state:{loginInfo:{user:null,isLoggedIn:null,idToken:null}},actions:{}});function N(e){var t=r.a.useContext(j).state.loginInfo,a=e.isMobile,s=Object(n.useState)(),c=Object(l.a)(s,2),o=c[0],i=c[1],f=Object(n.useState)([]),p=Object(l.a)(f,2),d=p[0],g=p[1],b=Object(n.useState)(!a),h=Object(l.a)(b,2),N=h[0],O=h[1];Object(n.useEffect)(function(){O(!a)},[a]);return Object(n.useEffect)(function(){t&&t.user&&t.user.userName&&i(t.user.userName),m.on("latestOnlineUsersArrived",function(e){"check"===e&&u.a.firestore().collection("users").where("status","==","online").get().then(function(e){var a=[];e.docs.forEach(function(e){if(e.data()){var n=e.data();t&&t.user&&t.user.userName!=n.userName&&(a.push(n),a.push(n),a.push(n),a.push(n),a.push(n),a.push(n),a.push(n),a.push(n),a.push(n),a.push(n),a.push(n),a.push(n),a.push(n),a.push(n),a.push(n),a.push(n),a.push(n),a.push(n))}}),g(a)})})},[]),r.a.createElement("div",null,r.a.createElement(v.a,{onSelect:function(e){},disabled:!a,expanded:N,onToggle:function(e){O(e)}},r.a.createElement(v.a.Toggle,null),r.a.createElement(v.a.Nav,{selected:"home"},r.a.createElement(E.NavItem,{eventKey:"home"},r.a.createElement(E.NavIcon,{className:"increased-height"},r.a.createElement("img",{className:"user-icon",style:{fontSize:"1.75em"}})),r.a.createElement(E.NavText,null,r.a.createElement("h4",null,o)),r.a.createElement(E.NavItem,null,r.a.createElement(E.NavText,{style:{align:"left"}},t.user?t.user.name:"no name")),r.a.createElement(E.NavItem,null,r.a.createElement(E.NavText,{style:{align:"left"}},t.user?t.user.email:"no email"))),r.a.createElement(E.NavItem,null,r.a.createElement(E.NavIcon,null),r.a.createElement(E.NavText,{style:{align:"left"}},r.a.createElement("div",{className:"online-user-heading"},"Online Users (",d.length,")"))),r.a.createElement("div",{className:"line"}),r.a.createElement("div",{className:"online-user-list"},r.a.createElement(v.a.Nav,null,d.map(function(e,t){return r.a.createElement(E.NavItem,{key:t},r.a.createElement(E.NavIcon,null,r.a.createElement("img",{className:"online-user user-icon"})),r.a.createElement(E.NavText,null,e.userName))}))))))}function O(e){var t=r.a.useState(),a=Object(l.a)(t,2),s=a[0],c=a[1],o=Object(n.useState)("emoji confused-emoji"),i=Object(l.a)(o,2),u=i[0],f=i[1],p=function(e,t){var a=Object(n.useState)(e),r=Object(l.a)(a,2),s=r[0],c=r[1];return Object(n.useEffect)(function(){var a=setTimeout(function(){c(e)},t);return function(){clearTimeout(a)}},[e]),s}(s,1e3),d=e.isMobile,h=Object(n.useContext)(j).state.loginInfo,E=!1;Object(n.useEffect)(function(){E||(E=!0,m.on("toneAnalysed",function(e){if(console.log(e),console.log(e.document_tone.tones),console.log(e.document_tone.tones.length),console.log(JSON.stringify(e.document_tone.tones)),e.document_tone.tones.length>0){var t=e.document_tone.tones[0].tone_id;if(console.log("here"),e.document_tone.tones.length>1)var a=(a=e.document_tone.tones).sort(function(e,t){return console.log(e.score),console.log(t.score),t.score-e.score});switch(console.log(a),t=a[0].tone_id,console.log(t),t){case"sadness":f("emoji sad-emoji");break;case"joy":f("emoji happy-emoji");break;case"anger":f("emoji angry-emoji");break;case"fear":f("emoji scared-emoji");break;default:f("emoji confused-emoji")}}else f("emoji confused-emoji")}))},[]),Object(n.useEffect)(function(){console.log(d)},[d]),Object(n.useEffect)(function(){p&&(s.length>0?O():f("emoji confused-emoji"))},[p]);var v=function(e){if(h.user&&e.length>0){var t={userName:h.user.userName,message:e,time:(new Date).getTime()};m.emit("newMessage",t),c("")}},N=function(){var e=Object(b.a)(g.a.mark(function e(){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("sending"),e.t0=u,e.next="emoji confused-emoji"===e.t0?4:"emoji happy-emoji"===e.t0?8:"emoji sad-emoji"===e.t0?11:"emoji scared-emoji"===e.t0?14:"emoji angry-emoji"===e.t0?17:19;break;case 4:return console.log("here"),e.next=7,v(":| ");case 7:return e.abrupt("break",19);case 8:return e.next=10,v(":) ");case 10:return e.abrupt("break",19);case 11:return e.next=13,v(":( ");case 13:return e.abrupt("break",19);case 14:return e.next=16,v(":E ");case 16:return e.abrupt("break",19);case 17:return e.next=19,v(":? ");case 19:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),O=function(){var e=Object(b.a)(g.a.mark(function e(){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("getting emoji");case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:d?"chat-input-layout-mobile":"chat-input-layout-desktop"},r.a.createElement("div",{className:"input-group"},r.a.createElement("textarea",{className:"form-control chat-input-field","aria-label":"Recipient's username","aria-describedby":"basic-addon2",name:"message",value:s,onChange:function(){var e=Object(b.a)(g.a.mark(function e(t){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c(t.target.value);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("label",{className:"input-group-text "},r.a.createElement("img",{className:u,id:"emoji",onClick:Object(b.a)(g.a.mark(function e(){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return alert("clock"),e.next=3,N();case 3:case"end":return e.stop()}},e)}))})),r.a.createElement("button",{className:"input-group-text",id:"basic-addon2",onClick:function(){v(s)}},r.a.createElement("img",{className:" emoji send-icon",alt:""})))))}var x=a(118),w=a(109),y=a(110),k=a.n(y),I=a(111),C=a.n(I),S=a(112),L=a.n(S),R=a(113),T=a.n(R),A=a(114),_=a.n(A);function U(e){var t=Object(n.useContext)(j).state.loginInfo;return t&&t.user&&t.user.userName?r.a.createElement("div",{className:"message"},r.a.createElement("div",{className:e.userName===t.user.userName?"my-message":"other-message"},r.a.createElement("div",{className:"message-box"},r.a.createElement("div",{className:"user-name"},e.userName),r.a.createElement("div",{className:"message-text"},":) "===e.message?r.a.createElement("div",{className:"emoji"},r.a.createElement("img",{alt:":)",className:"emoji",src:k.a})):":| "===e.message?r.a.createElement("div",{className:"emoji"},r.a.createElement("img",{alt:":|",className:"emoji",src:L.a})):":( "===e.message?r.a.createElement("div",{className:"emoji"},r.a.createElement("img",{alt:":(",className:"emoji",src:C.a})):":? "===e.message?r.a.createElement("div",{className:"emoji"},r.a.createElement("img",{alt:":?",className:"emoji",src:T.a})):":E "===e.message?r.a.createElement("div",{className:"emoji"},r.a.createElement("img",{alt:":E ",className:"emoji",src:_.a})):e.message),r.a.createElement("div",{className:"time"},e.time?Object(w.format)(e.time,"hh:mm a"):"")))):null}function D(){var e=Object(n.useState)([]),t=Object(l.a)(e,2),a=t[0],s=t[1],c=Object(n.useState)(),o=Object(l.a)(c,2),i=o[0],u=o[1],f=!1;return Object(n.useEffect)(function(){f||(m.connected||m.connect(),f=!0,m.emit("requestAllMessages",{data:"OK"}),m.on("getAllMessages",function(e){e.forEach(function(e){u(e)})}),m.on("getNewMessage",function(e){var t={userName:e.userName,message:e.message,time:e.time};u(t)}))},[]),Object(n.useEffect)(function(){s([].concat(Object(x.a)(a),[i]))},[i]),r.a.createElement("div",{className:"chats"},a.map(function(e,t){if(e)return r.a.createElement(U,{message:e.message,userName:e.userName,time:e.time,key:t})}))}function M(){var e=Object(n.useState)(!1),t=Object(l.a)(e,2),a=t[0],s=t[1],c=!1;return window.addEventListener("resize",function(e){window.innerWidth<=700?s(!0):s(!1)}),Object(n.useEffect)(function(){c||(c=!0,window.innerWidth<=700?s(!0):s(!1))},[]),Object(n.useEffect)(function(){a?document.getElementsByClassName("vanish")[0].className="sidenav---sidenav-toggle---1KRjR":document.getElementsByClassName("sidenav---sidenav-toggle---1KRjR")[0].className="vanish"},[a]),r.a.createElement(r.a.Fragment,null,r.a.createElement(N,{isMobile:a}),r.a.createElement("main",{className:a?"chat-body-mobile":"chat-body-desktop"},r.a.createElement(h,null),r.a.createElement(D,null)),r.a.createElement(O,{isMobile:a}))}function P(e){var t=Object(n.useContext)(j),a=(t.state.loginInfo,t.actions.signUp),s=Object(n.useState)(""),c=Object(l.a)(s,2),o=c[0],i=c[1],u=Object(n.useState)(""),m=Object(l.a)(u,2),p=m[0],d=m[1],h=Object(n.useState)(""),E=Object(l.a)(h,2),v=E[0],N=E[1],O=Object(n.useState)(""),x=Object(l.a)(O,2),w=x[0],y=x[1],k=Object(n.useState)(""),I=Object(l.a)(k,2),C=I[0],S=I[1],L=Object(n.useState)({type:null,error_message:null}),R=Object(l.a)(L,2),T=(R[0],R[1],function(){var e=Object(b.a)(g.a.mark(function e(t){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),null!=o&&null!=p&&null!=w&&null!=v){e.next=5;break}alert("one or more fields might be empty"),e.next=12;break;case 5:if(w===C){e.next=9;break}alert("password and alert password do not match"),e.next=12;break;case 9:return e.next=11,a(p,w,o,v);case 11:e.sent;case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());return r.a.createElement("div",null,r.a.createElement("div",{className:"basic-form"},r.a.createElement("h2",{className:""},"Register"),r.a.createElement("form",{onSubmit:function(e){T(e)}},r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("input",{type:"text",name:"userName",onChange:function(e){i(e.target.value)},className:"form-control",placeholder:"Username"})),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("input",{type:"text",name:"name",onChange:function(e){N(e.target.value)},className:"form-control",placeholder:"Full Name"})),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("input",{type:"email",name:"email",onChange:function(e){d(e.target.value)},className:"form-control",placeholder:"Email-Id"})),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("input",{type:"password",name:"password",id:"password",onChange:function(e){y(e.target.value)},className:"form-control",placeholder:"Password"})),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("input",{type:"password",name:"rPassword",onChange:function(e){S(e.target.value)},className:"form-control",placeholder:"Repeat Password"})),r.a.createElement("button",{type:"submit",className:"btn btn-primary",onClick:T},"Register")),r.a.createElement(f.b,{to:"/login",className:"hyperlink"},"Login")))}function B(e){var t=Object(n.useContext)(j),a=(t.state.loginInfo,t.actions.login),r=Object(n.useState)(""),s=Object(l.a)(r,2),c=s[0],o=s[1],i=Object(n.useState)(""),u=Object(l.a)(i,2),m=u[0],p=u[1],d=function(){var e=Object(b.a)(g.a.mark(function e(t){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,a(c,m);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return n.createElement("div",null,n.createElement("div",{className:"basic-form"},n.createElement("form",{onSubmit:function(e){d(e)}},n.createElement("div",{className:"input-group mb-3"},n.createElement("input",{type:"email",name:"email",onChange:function(e){o(e.target.value)},className:"form-control",placeholder:"Email-Id"})),n.createElement("div",{className:"input-group mb-3"},n.createElement("input",{type:"password",name:"password",onChange:function(e){p(e.target.value)},className:"form-control",placeholder:"Password"})),n.createElement("button",{type:"submit",className:"btn btn-primary"},"Login")),n.createElement(f.b,{to:"/",className:"hyperlink"},"Register")))}var K=a(117),W=a.n(K);function z(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:W.a,className:"app-icon"}),"signup"===e.page?r.a.createElement(P,null):r.a.createElement(B,null))}var J,F=a(28);function X(){var e=Object(n.useState)({open:!1,message:"",timeout:0}),t=Object(l.a)(e,2),a=t[0],s=t[1],c=function(e){var t=e.message,a=e.timeout,n=e.onhide;s({timeout:a,open:!0,message:t,onhide:n})};return Object(n.useEffect)(function(){J=c},[]),r.a.createElement("div",{className:"alert alert-warning alert-dismissible fade show",role:"alert",hidden:!a.open},r.a.createElement("strong",null,a.message),r.a.createElement("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:function(){s(Object(F.a)({},a,{open:!1}))}},r.a.createElement("span",{"aria-hidden":"true"},"\xd7")))}function q(e){J(Object(F.a)({},e))}function G(e){var t=Object(n.useState)({isLoggedIn:null,user:null,uid:null}),a=Object(l.a)(t,2),s=a[0],c=a[1],o=function(){var e=Object(b.a)(g.a.mark(function e(t,a){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:u.a.auth().signInWithEmailAndPassword(t,a).then(function(){var e=Object(b.a)(g.a.mark(function e(t){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){q({message:e.message})});case 1:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),i=function(){return u.a.firestore()},f=function(){var e=Object(b.a)(g.a.mark(function e(t,a,n,r){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i().collection("users").doc(n).get();case 2:if(!e.sent.exists){e.next=8;break}return q({message:"Username Already Exists"}),e.abrupt("return",!1);case 8:return e.next=10,u.a.auth().createUserWithEmailAndPassword(t,a).then(function(){var e=Object(b.a)(g.a.mark(function e(a){var s;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.user){e.next=7;break}return s={email:t,userName:n,uid:a.user.uid,status:"online",name:r},e.next=4,i().collection("users").doc(n).set(s);case 4:return e.next=6,i().collection("usernames").doc(a.user.uid).set({username:n});case 6:return e.abrupt("return",!0);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){return q({message:e.message,timeout:3e3}),!1}).catch(function(e){return q({message:e.message,timeout:3e3}),!1});case 10:case"end":return e.stop()}},e)}));return function(t,a,n,r){return e.apply(this,arguments)}}();return r.a.createElement(j.Provider,{value:{state:{loginInfo:s},actions:{login:o,getUserDetails:function(e){i().collection("users").where("uid","==",e).get().then(function(e){if(e){var t=e.docs[0].data();if(t){var a={email:t.email,name:t.name,uid:t.uid,status:t.status,userName:t.userName};m.emit("change_username",{username:t.userName}),c(Object(F.a)({},s,{user:a}))}}}).catch(function(e){console.log(e)})},signUp:f,setLoginDetails:function(e){c(e)}}}},e.children)}function H(){return r.a.createElement("div",{className:"loading-background"},r.a.createElement("div",{className:"loading-icon-container"},r.a.createElement("img",{className:"rotate"})))}var Q=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(G,null,r.a.createElement(X,null),r.a.createElement(f.a,null,r.a.createElement(p.d,null,r.a.createElement(p.b,{path:"/",exact:!0,render:function(e){return r.a.createElement($,{page:"signup"})}}),r.a.createElement(p.b,{path:"/login",exact:!0,render:function(e){return r.a.createElement($,{page:"login"})}}),r.a.createElement(V,{path:"/Chat",component:M})))))};function $(e){var t=Object(n.useContext)(j),a=t.state.loginInfo,s=t.actions,c=s.setLoginDetails,o=s.getUserDetails,i=!1;return Object(n.useEffect)(function(){i||(i=!0,u.a.auth().onAuthStateChanged(function(e){c(e?{isLoggedIn:!0,uid:e.uid,user:null}:{isLoggedIn:!1,uid:null,user:null})},function(e){}))},[]),a&&null!=a.uid&&!0===a.isLoggedIn&&null===a.user&&o(a.uid),a&&!0===a.isLoggedIn&&null!=a.uid&&null!=a.user?r.a.createElement(p.a,{to:"/Chat"}):!1===a.isLoggedIn?r.a.createElement(z,{page:e.page}):r.a.createElement(H,null)}function V(e){var t=e.component,a=Object(o.a)(e,["component"]),s=Object(n.useContext)(j).state.loginInfo;return r.a.createElement(p.b,Object.assign({},a,{render:function(e){return s.isLoggedIn?r.a.createElement(t,e):r.a.createElement(p.a,{to:"/login"})}}))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.initializeApp({apiKey:"AIzaSyBcp3foKTJXDg-zxijmR1nS3Gwf28LXQHo",authDomain:"chatapp-529b9.firebaseapp.com",databaseURL:"https://chatapp-529b9.firebaseio.com",projectId:"chatapp-529b9",storageBucket:"",messagingSenderId:"884053658028",appId:"1:884053658028:web:01b7a181476a366d"}),c.a.render(r.a.createElement(Q,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[120,1,2]]]);
//# sourceMappingURL=main.30b182f2.chunk.js.map